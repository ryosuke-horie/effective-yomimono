# アクティブコンテキスト

## 現在の開発状況

### 実装済み機能
1. コアワークフロー
   - タブ情報の収集と保存
   - 記事一覧の表示
   - お気に入り機能

2. インフラ整備
   - Cloudflareへのデプロイ
   - DB (D1) セットアップ
   - CI/CD パイプライン

3. 品質管理
   - 静的解析の導入（Biome, knip）
   - APIのユニットテスト整備 (カバレッジ90%以上維持)
   - エラーハンドリングの実装
   - **ラベリング機能 (バックエンドAPI & テスト)**

## 現在のフォーカス

### ラベリング機能の実装
1. **MCPサーバー実装**:
   - ✅ 基本的なMCPサーバー (`mcp/` ディレクトリ) のセットアップ完了。
   - ✅ `StdioTransport` を使用したサーバー起動実装完了 (`mcp/src/index.ts`)。
   - ✅ バックエンドAPIクライアント実装完了 (`mcp/src/lib/apiClient.ts`)。
   - ✅ `autoLabelArticles` Tool実装完了（API経由でのラベル登録処理のみ。LLM判断はクライアント側で行う想定）。
   - ✅ MCP Inspector経由での接続・Tool実行を確認済み。
   - **今後のステップ**: Transport検討 (Stdio -> SSE?)、テスト実装。
2. **API修正**:
   - ✅ `LabelService` (`api/src/services/label.ts`) の既存ラベルチェックを削除し、「1記事複数ラベル」仕様に対応。
3. **フロントエンド実装**:
   - 記事カードへのラベル表示。
   - ラベルによるフィルタリング機能の実装。

### 技術的改善 (継続)
1. パフォーマンス最適化
   - クエリの効率化
   - フロントエンドのキャッシング
2. 開発者体験の向上
   - ドキュメントの充実 (メモリバンク更新含む)

## アクティブな決定事項

### アーキテクチャ
1. レイヤー分離の徹底
   - Repository パターンの採用
   - ビジネスロジックの集約
   - **ラベリング用APIエンドポイント**:
     - `GET /api/labels` (実装済み)
     - `GET /api/bookmarks/unlabeled` (実装済み)
     - `PUT /api/bookmarks/:id/label` (実装済み、複数ラベル対応に修正済み)
     - `GET /api/bookmarks?label=` (実装済み)

2. フロントエンド設計
   - カスタムフックによる状態管理
   - コンポーネントの責務明確化

### 開発プロセス
1. コード品質
   - Biomeによる一貫したコードスタイル
   - テストカバレッジ90%以上の維持

2. デプロイメント
   - 自動デプロイの継続
   - ゼロダウンタイムの実現

## 最近の学び

### 技術的な発見
1. Cloudflare Workers
   - エッジでの実行時の制約
   - D1との効率的な連携方法

2. Next.js App Router
   - サーバーコンポーネントの活用
   - ルーティング設計のベストプラクティス

### 改善点
1. エラーハンドリング
   - エラーの種類に応じた適切な対応
   - ユーザーフレンドリーなエラー表示

2. パフォーマンス
   - バンドルサイズの最適化
   - APIレスポンスの高速化

## 次のステップ

### 短期目標 (現在進行中)
1. **ラベリング機能**:
   - Claude Desktop側でのMCP Tool呼び出しとLLM連携実装。
   - フロントエンドへのラベル表示・フィルタリング機能の組み込み。
2. **その他機能強化 (並行または後続)**:
   - 未読記事数の表示機能実装
   - UI/UXの改善 (継続)

### 中期目標
1. 機能拡張
   - タグ機能の導入
   - 検索機能の実装

2. インフラ
   - モニタリングの強化
   - バックアップ戦略の確立

## 注意点・懸念事項

### 技術的な制約
1. Cloudflare Workers
   - 実行時間制限への対応
   - メモリ使用量の管理

2. D1 Database
   - トランザクション制限の考慮
   - データ量増加への対策

### 開発プロセス
1. 品質管理
   - テストカバレッジの維持
   - コードレビューの効率化

2. ドキュメンテーション
   - 設計判断の記録
   - API仕様の更新
