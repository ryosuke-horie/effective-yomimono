# GitHub Actions ワークフロー

このプロジェクトでは、APIとフロントエンドそれぞれのテスト自動化のためにGitHub Actionsを使用しています。

## ワークフロー概要

### 1. APIテスト（api-test.yml）

- **トリガー**:
  - `api/**` 配下のファイルが変更された場合
  - mainブランチへのプッシュ
  - プルリクエスト

- **実行内容**:
  - Node.js環境のセットアップ
  - 依存関係のインストール
  - テストの実行（カバレッジレポート生成）
  - カバレッジの閾値チェック（80%以上）
  - PRへのカバレッジ情報コメント
  - カバレッジレポートのアーティファクトアップロード

### 2. フロントエンドテスト（frontend-test.yml）

- **トリガー**:
  - `frontend/**` 配下のファイルが変更された場合
  - mainブランチへのプッシュ
  - プルリクエスト

- **実行内容**:
  - Node.js環境のセットアップ
  - 依存関係のインストール
  - Vitestによるテスト実行（カバレッジレポート生成）
  - カバレッジの閾値チェック（80%以上）
  - PRへのカバレッジ情報コメント
  - カバレッジレポートのアーティファクトアップロード

## カバレッジレポート

両ワークフローとも、以下の指標でコードカバレッジを計測します：

- Statements（ステートメント）カバレッジ
- Branches（分岐）カバレッジ
- Functions（関数）カバレッジ
- Lines（行）カバレッジ

閾値は80%に設定されており、これを下回るとワークフローが失敗します。

## プルリクエストへのフィードバック

プルリクエスト時には、自動的に以下の情報がPRにコメントされます：

- 全体のカバレッジ率
- 各指標の詳細なカバレッジ率
- 閾値との比較結果
- 合否ステータス

## アーティファクト

テスト実行後、カバレッジレポートは7日間保存されるアーティファクトとしてアップロードされます。これにより、詳細な分析が必要な場合に参照できます。

## 注意事項

1. カバレッジ閾値（80%）を下回る場合：
   - ワークフローは失敗します
   - PRにその旨が通知されます
   - テストの追加または改善が必要です

2. パスによるトリガー：
   - APIとフロントエンドのワークフローは独立して動作します
   - 関連するディレクトリの変更のみをトリガーとします
   - これにより、不要なテスト実行を防ぎます