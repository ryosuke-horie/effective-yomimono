# ラベリング機能要件

## 1. ラベリング実行機能

### 1.1 実行トリガー
- ユーザーがClaude Desktopからラベリング処理を指示
- 指示はユーザーの任意のタイミングで実行可能

### 1.2 対象記事の取得
- ラベルが未設定の記事を一括で取得
- 以下の情報を含む：
  - 記事ID
  - 記事タイトル
  - URL
  - 作成日時

### 1.3 既存ラベル情報の取得
- 現在登録されている全ラベルの一覧を取得
- 以下の情報を含む：
  - ラベルID
  - ラベル名
  - 作成日時

### 1.4 ラベル判断と付与
- Claude Desktopが記事ごとに適切なラベルを判断
- 判断基準：
  - 記事タイトルの内容分析
  - 既存ラベルとの整合性確認
  - 表記揺れや類似ラベルの考慮
- ラベル付与方法：
  - 既存ラベルから最適なものを選択
  - 適切なラベルがない場合は新規ラベルを生成
  - APIを通じて記事とラベルを紐付け

## 2. ラベル管理機能

### 2.1 新規ラベル生成
- Claude Desktopの判断により新規ラベルを生成
- ラベル名の正規化処理：
  - 全角文字を半角に変換
  - 小文字に統一
  - 前後の空白を除去
- 表記揺れや類似ラベルの重複を防止

### 2.2 ラベル運用ルール
- ユーザーによる手動でのラベル操作は不可
- すべてのラベル操作はClaude Desktop経由で実行
- ラベルの編集・削除機能は提供しない

### 2.3 記事-ラベル紐付け
- 1つの記事に対して1つのラベルを付与
- 既存の紐付けは上書き不可（将来の要件で検討）

## 3. フロントエンド機能

### 3.1 ラベル表示
- 記事一覧の各カードにラベルを表示
- 表示項目：
  - ラベル名
  - （必要に応じて）視覚的な装飾

### 3.2 フィルタリング機能
- ラベルによる記事のフィルタリング
- 機能要件：
  - ラベル一覧からの選択
  - 選択したラベルに紐付く記事の表示
  - フィルタのクリア機能

## 4. API要件

### 4.1 提供API
1. 未ラベル記事取得API
   - エンドポイント: `GET /articles/unlabeled`
   - レスポンス: 未ラベル記事の一覧

2. ラベル一覧取得API
   - エンドポイント: `GET /labels`
   - レスポンス: 登録済みラベルの一覧

3. ラベル付与API
   - エンドポイント: `PUT /articles/{articleId}/label`
   - リクエスト: ラベル名（または既存ラベルID）
   - 処理: ラベルの存在確認、必要に応じて新規作成、紐付け

### 4.2 エラーハンドリング
- 適切なHTTPステータスコードの使用
- エラーメッセージの提供
- リトライ可能なエラーの識別

### 4.3 パフォーマンス要件
- 一括処理の対応
- 適切なレスポンスタイム
- DB接続の効率的な管理

## 5. 将来対応

### 5.1 認証・認可
- Cloudflare Accessの導入
- APIトークンによる認証
- アクセス制御の実装

### 5.2 機能拡張
- ラベル付けの判断基準の調整機能
- 表記揺れ・類似ラベル判定の精度向上
- 複数ラベル付与の検討
