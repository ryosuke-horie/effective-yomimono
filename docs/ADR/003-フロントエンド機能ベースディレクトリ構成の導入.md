# ADR-003: フロントエンド機能ベースディレクトリ構成の導入

## ステータス

承認済み

## コンテキスト

現在、フロントエンド (`frontend/src/`) のディレクトリ構成は、`app`, `components`, `hooks`, `lib`, `types` といった技術的な関心事に基づいている。TanStack Query の導入に伴い、データ取得・更新ロジックを専用のフックに分離する必要性が生じた。

今後の機能追加やコードベースの成長を見据え、関連するコンポーネント、フック、クエリ、型定義などを機能単位でまとめ、より凝集度が高く、メンテナンスしやすい構成に移行することを検討した。

## 決定

フロントエンドのソースコード構成として、**機能ベース (feature-based) のディレクトリ構造**を導入する。

具体的には、`frontend/src/features/` ディレクトリを作成し、その配下に各機能（例: `bookmarks`）ごとのディレクトリを配置する。各機能ディレクトリ内には、その機能に関連する `components`, `hooks`, `queries`, `types` などを配置する。

```
frontend/src/
├── app/         # ルーティング、グローバルレイアウト
├── components/  # 複数の機能で共有される汎用コンポーネント
├── features/    # 機能ごとのモジュール
│   └── bookmarks/
│       ├── components/ # ブックマーク機能固有のコンポーネント
│       ├── hooks/      # ブックマーク機能固有のUIロジックフック
│       ├── queries/    # ブックマーク関連のTanStack Queryフック
│       └── types.ts    # ブックマーク関連の型定義
├── hooks/       # グローバルなカスタムフック
├── lib/         # APIクライアント設定など
├── types/       # グローバルな型定義
└── ...
```

汎用的なコンポーネントやフック、型定義は引き続きトップレベルの `components`, `hooks`, `types` ディレクトリに配置する。

## 検討された選択肢

1.  **現状維持:** 技術的な関心事に基づく構成。機能が増えるにつれて関連ファイルが散在し、見通しが悪くなる可能性がある。
2.  **`queries` ディレクトリの導入:** TanStack Query 関連のフックを `src/queries` に集約する案。データアクセスロジックはまとまるが、UI コンポーネントや関連フックとの物理的な距離が離れる。
3.  **機能ベースディレクトリ構成 (今回採用):** 機能ごとに関連ファイルをまとめる。凝集度が高く、スケーラビリティに優れる。

## 結果

### ポジティブな影響

*   **関心の分離と凝集度の向上:** 機能ごとに関連コードがまとまるため、コードの理解と変更が容易になる。
*   **スケーラビリティの向上:** 新機能の追加や既存機能の変更が、他の機能への影響を最小限に抑えつつ行える。
*   **見通しの改善:** プロジェクト全体の構造が機能単位で把握しやすくなる。
*   **再利用性の明確化:** 機能固有のコンポーネント/フックと、共有される汎用コンポーネント/フックの区別がつきやすくなる。

### ネガティブな影響

*   **ディレクトリ構造の深化:** ファイルへのパスが長くなる可能性がある。
*   **初期リファクタリングコスト:** 既存のコードを新しい構造に移動・整理する手間が発生する。
*   **どこに配置するかの判断:** 新しいファイルを作成する際に、機能固有か汎用かの判断が必要になる場合がある。

## 次のステップ

TanStack Query 導入と並行して、既存のブックマーク関連コード (`BookmarkCard`, `BookmarksList`, `useBookmarks`, `types/bookmark.ts` など) を `frontend/src/features/bookmarks/` 配下に移動し、新しい構成に合わせてリファクタリングする。
